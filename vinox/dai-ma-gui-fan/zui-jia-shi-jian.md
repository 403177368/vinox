# 最佳实践？

| --          | Good Cases                                                                                                                                                                             | Bad Cases                                                                            | --                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| ----------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 命名          | 花一点时间起一个恰当的命名。                                                                                                                                                                         | <ul><li>先随便起一个。</li><li>看到别人已经起好了，照抄。</li></ul>                                      | <ul><li>There are only two hard things in Computer Science: <em>cache invalidation and naming things</em>. -- Phil Karlton.</li><li>A bad name will mislead you and stop you from understanding the true meaning of a concept.</li></ul>                                                                                                                                                                                                                                                                                                                                                 |
| 命名          | PascalCase、camelCase、kebab-case、snake\_case                                                                                                                                            | whatever\_Case                                                                       | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| 命名          | userList, userMap                                                                                                                                                                      | users                                                                                | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| 命名          | isSupported isUserLoggedIn                                                                                                                                                             | isSupport isLogin                                                                    | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| 命名          | toWebPage()                                                                                                                                                                            | jumpWebPage()                                                                        | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| 命名          | <ul><li>ComponentName.vue</li><li>ComponentName.tsx</li><li>ComponentNameV2.vue</li></ul>                                                                                              | <ul><li>componentName.vue</li><li>component_name.vue</li></ul>                       | <ul><li>The name of a component file should be pascal-cased and globally unique.</li><li>Avoid using over-simple names.</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| 命名          | const self = this;                                                                                                                                                                     | <ul><li>const that = this;</li><li>const _this = this;</li></ul>                     | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| 命名          | <ul><li>onConfirmButtonClicked</li><li>onFinished</li><li>onFailed</li></ul>                                                                                                           | <p><br></p>                                                                          | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| 命名          | 尽量不使用缩写。                                                                                                                                                                               | 使用一些自创的、难懂的“缩写”。temp, recom                                                          | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| ts          | 保持类型正确                                                                                                                                                                                 | 直接用any                                                                               | <ul><li>Easier to find bugs in compile time.</li><li>Let other people have a better understanding of your code.</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| ts          | const a: UserInfo = {...};                                                                                                                                                             | const a = {...} as UserInfo;                                                         | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| ts          | someFunction(name: string): void;                                                                                                                                                      | someFunction: Function;                                                              | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| ts          | id: string;                                                                                                                                                                            | id: number;                                                                          | <ul><li>JavaScript number has an upper limit thus a too big id number will overflow.</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| ts          | <p>TypeScript类型命名风格：</p><p>User</p><p>IUser 匈牙利命名法，Java中常用，对ts来说不是太必要。</p><p><a href="https://www.1024sou.com/article/256296.html">https://www.1024sou.com/article/256296.html</a></p> | <ul><li>InUser</li><li>InterUser</li></ul>                                           | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| ts          | <p>同一类型的对象只定义一个Type。</p><p>ts类型定义的混乱是致命的，类型定义的混乱 往往表征着 对逻辑理解的混乱。</p>                                                                                                                   | <p>为了通过ts类型检查临时定义一个类名。</p><p>定义了多个Type去表示同一个类型。</p>                                  | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| ts          | <p>ts中非必要不使用'?'</p><p>interface User { id: string; name: string; }</p>                                                                                                                 | <p>每个字段必加'?'</p><p>interface User { id?: string; name?: string }</p>                 | <ul><li>很早之前就发现好多同学喜欢给类型字段加？，最终就变成这样</li><li>每个字段都可能不存在，你也不知道它必不必须存在，每个字段用之前都得判断</li><li>别人要创建一个你这种对象，完全不知道该赋值几个字段，因为全都可以没有</li><li>类型完全失去约束力</li><li>'?'的滥用会加大代码的混乱度。每加一个？，随之而来的可能是n个if或？或！或as。尤其是as，每多加一个as就多一个漏洞。最终发展成每一个字段都标?，类型名存实亡。</li></ul>                                                                                                                                                                                                                                                                                                                                      |
| <p><br></p> | <p><br></p>                                                                                                                                                                            | <p><br></p>                                                                          | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| css         | 嵌套类名、scoped、css module                                                                                                                                                                 | 全局类名                                                                                 | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| css         | .xxxWrapper {  }                                                                                                                                                                       | .xxxWrap {  }                                                                        | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| css         | css中使用类名                                                                                                                                                                               | css中使用id、div、img、ul、li、span、\*                                                       | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| css         | <p><br></p>                                                                                                                                                                            | <ul><li>:first-child</li><li>:last-child</li><li>:nth-child</li></ul>                | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| 架构          | 没有问题就不做优化。                                                                                                                                                                             | 为了做“优化”反而影响了正常功能。                                                                    | Premature optimization is the root of all evil.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| 架构          | 仓库支持多个html入口                                                                                                                                                                           | 仓库只支持一个html入口                                                                        | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| 架构          | 环境变量等信息放在全局store里                                                                                                                                                                      | 随便放哪里都行                                                                              | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| 架构          | react项目使用mobx。                                                                                                                                                                         | 使用redux、easy-peasy等。                                                                 | <p>React本身存在的问题：</p><ol><li>提供的api过于基础，许多常用功能留待用户自己封装解决。</li><li>用useState声明状态太松散、太冗长。</li><li>缺少computed这种非常实用的功能。</li><li>不存在依赖追踪机制，需要手动使用React.memo等api做性能优化，繁琐、难度大且易产生bug。</li><li>状态和方法需要零散地通过props层层传递给子组件，难以维护。当项目特别复杂时尤甚。</li><li>对 setInterval window.addEventListener 这种功能支持度不好，需要小心避免踩坑。</li></ol><p>使用mobx的理由：</p><ol><li>完整的computed功能。</li><li>完整的依赖追踪机制，以组件为单位重新渲染，基本不需要再手动进行性能优化。</li><li>完整的store功能，避免层层传递props。</li></ol><p>Advantages of mobx:</p><ul><li>Automatic dependency tracking.</li><li>True `computed` functionality.</li><li>Better performance?</li></ul> |
| 架构          | vue项目则使用export const store = new Vue()足够。                                                                                                                                              | 使用vuex。                                                                              | Vuex has a bad support for TypeScript.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 架构          | 直接使用rem做单位。                                                                                                                                                                            | 使用px2rem把px转换成rem。                                                                   | <ul><li>px2rem can not transform `px` in javascript files into `rem`.</li><li>Unable to use px in style files while using px2rem.</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| 组件          | 静态资源文件放在所属组件文件夹里。                                                                                                                                                                      | 静态资源文件都放在一个文件夹里                                                                      | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| 组件          | import '@/components/'                                                                                                                                                                 | import '@components'                                                                 | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| 组件          | MyComponent/index.vue                                                                                                                                                                  | <p><br></p>                                                                          | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| 组件          | 把函数作为prop传入子组件                                                                                                                                                                         | this.$emit                                                                           | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| 组件          | 大组件使用动态加载。                                                                                                                                                                             | 不使用任何动态加载。                                                                           | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| components  | 产出公共组件和函数。产出高度可复用的代码和开源lib往往标志着一个程序员的能力。                                                                                                                                               | 复制黏贴代码再改改                                                                            | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| components  | 使用CommonExposure组件处理曝光埋点问题                                                                                                                                                             | 每次都自己手写                                                                              | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| components  | DropArea                                                                                                                                                                               | <p><br></p>                                                                          | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| <p><br></p> | <p><br></p>                                                                                                                                                                            | <p><br></p>                                                                          | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| utils       | toWebPage()                                                                                                                                                                            | 每个跳转都手写                                                                              | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| utils       | getSearchParams()                                                                                                                                                                      | 每次都手写                                                                                | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| utils       | resolveURL()                                                                                                                                                                           | 每次手动拼url字符串                                                                          | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| utils       | 客户端的jssdk方法外层再进行一层封装。                                                                                                                                                                  | 不封装，直接用                                                                              | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| <p><br></p> | \<img>                                                                                                                                                                                 | background: url(...);                                                                | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| <p><br></p> | 路由信息放到route.meta                                                                                                                                                                       | <p><br></p>                                                                          | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| <p><br></p> | 生产环境不出现无用console                                                                                                                                                                       | <p><br></p>                                                                          | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| <p><br></p> | str.trim()                                                                                                                                                                             | str.replace(/^\s+\|\s+$/g, '');                                                      | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| <p><br></p> | 不使用可能有浏览器兼容性问题的、太新的api。                                                                                                                                                                | <p><br></p>                                                                          | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| <p><br></p> | <p>必要的时候使用throw new Error抛出异常。</p><p>必要的时候使用try catch语句处理异常。</p>                                                                                                                       | <p>把异常内部处理掉，不引起注意，美其名曰“容错”。</p><p>使用await-to-js。（是对golang处理异常方式的拙劣模仿，没有语言层面的支持。）</p> | <ul><li>Errors should be catch then handled where the action is triggered, but not in a sub-action.</li></ul>                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| <p><br></p> | 使用tinypng等压缩图片                                                                                                                                                                         | 无论图片多大都不压缩                                                                           | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| <p><br></p> | /product?id=                                                                                                                                                                           | <p>/product?productInfo=</p><p>通过url参数传递一大堆数据到详情页。</p>                               | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| <p><br></p> | <p>排查问题的方法：</p><p>先把代码全部注释掉，然后一点一点加回来，看在哪一步出现了问题。</p>                                                                                                                                  | <p><br></p>                                                                          | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| <p><br></p> | 理解代码分层的意义，代码要出现在它应该出现的层里。                                                                                                                                                              | <p><br></p>                                                                          | <p><br></p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| <p><br></p> | textAlign: 'left' \| 'right' \| 'center';                                                                                                                                              | textAlign: 1 \| 2 \| 3;                                                              |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
