# 最佳实践？

<table data-full-width="true"><thead><tr><th width="112">--</th><th width="419">Good Cases</th><th width="439">Bad Cases</th><th width="420">Description</th></tr></thead><tbody><tr><td>命名</td><td>花一点时间起一个恰当的命名。</td><td><ul><li>先随便起一个。</li><li>看到别人已经起好了，照抄。</li></ul></td><td><ul><li>There are only two hard things in Computer Science: <em>cache invalidation and naming things</em>. -- Phil Karlton.</li><li>A bad name will mislead you and stop you from understanding the true meaning of a concept.</li></ul></td></tr><tr><td>命名</td><td>PascalCase、camelCase、kebab-case、snake_case</td><td>whatever_Case</td><td><br></td></tr><tr><td>命名</td><td>userList, userMap</td><td>users</td><td><br></td></tr><tr><td>命名</td><td>isSupported isUserLoggedIn</td><td><p><mark style="color:red;">isSupport</mark></p><p><mark style="color:red;">isLogin</mark></p></td><td><br></td></tr><tr><td>命名</td><td>toWebPage()</td><td>jumpWebPage()</td><td><br></td></tr><tr><td>命名</td><td><ul><li>ComponentName.vue</li><li>ComponentName.tsx</li><li>ComponentNameV2.vue</li></ul></td><td><ul><li>componentName.vue</li><li>component_name.vue</li></ul></td><td><ul><li>The name of a component file should be pascal-cased and globally unique.</li><li>Avoid using over-simple names.</li></ul></td></tr><tr><td>命名</td><td>const self = this;</td><td><ul><li>const that = this;</li><li>const _this = this;</li></ul></td><td><br></td></tr><tr><td>命名</td><td><ul><li>onConfirmButtonClicked</li><li>onFinished</li><li>onFailed</li></ul></td><td><br></td><td><br></td></tr><tr><td>命名</td><td>尽量不使用缩写。</td><td>使用一些自创的、难懂的“缩写”。temp, recom</td><td><br></td></tr><tr><td>ts</td><td>保持类型正确</td><td><mark style="color:red;">直接用any</mark></td><td><ul><li>Easier to find bugs in compile time.</li><li>Let other people have a better understanding of your code.</li></ul></td></tr><tr><td>ts</td><td>const a: UserInfo = {...};</td><td>const a = {...} as UserInfo;</td><td><br></td></tr><tr><td>ts</td><td>someFunction(name: string): void; </td><td>someFunction: Function;</td><td><br></td></tr><tr><td>ts</td><td>id: string;</td><td>id: number;</td><td><ul><li>JavaScript number has an upper limit thus a too big id number will overflow.</li></ul></td></tr><tr><td>ts</td><td><p>TypeScript类型命名风格：</p><p>User</p><p>IUser 匈牙利命名法，Java中常用，对ts来说不是太必要。</p><p><a href="https://www.1024sou.com/article/256296.html">https://www.1024sou.com/article/256296.html</a></p></td><td><ul><li>InUser</li><li>InterUser</li></ul></td><td><br></td></tr><tr><td>ts</td><td><p>同一类型的对象只定义一个Type。</p><p>ts类型定义的混乱是致命的，类型定义的混乱 往往表征着 对逻辑理解的混乱。</p></td><td><p>为了通过ts类型检查临时定义一个类名。</p><p>定义了多个Type去表示同一个类型。</p></td><td><br></td></tr><tr><td>ts</td><td><p>ts中非必要不使用'?'</p><p>interface User { id: string; name: string; }</p></td><td><p>每个字段必加'?'</p><p>interface User { id?: string; name?: string }</p></td><td><ul><li>很早之前就发现好多同学喜欢给类型字段加？，最终就变成这样</li><li>每个字段都可能不存在，你也不知道它必不必须存在，每个字段用之前都得判断</li><li>别人要创建一个你这种对象，完全不知道该赋值几个字段，因为全都可以没有</li><li>类型完全失去约束力</li><li>'?'的滥用会加大代码的混乱度。每加一个？，随之而来的可能是n个if或？或！或as。尤其是as，每多加一个as就多一个漏洞。最终发展成每一个字段都标?，类型名存实亡。</li></ul></td></tr><tr><td><br></td><td><br></td><td><br></td><td><br></td></tr><tr><td>css</td><td>嵌套类名、scoped、css module</td><td>全局类名</td><td><br></td></tr><tr><td>css</td><td>.xxxWrapper {  }</td><td>.xxxWrap {  }</td><td><br></td></tr><tr><td>css</td><td>css中使用类名</td><td>css中使用id、div、img、ul、li、span、*</td><td><br></td></tr><tr><td>css</td><td><br></td><td><ul><li>:first-child</li><li>:last-child</li><li>:nth-child</li></ul></td><td><br></td></tr><tr><td>架构</td><td>没有问题就不做优化。</td><td>为了做“优化”反而影响了正常功能。</td><td>Premature optimization is the root of all evil.</td></tr><tr><td>架构</td><td>仓库支持多个html入口</td><td>仓库只支持一个html入口</td><td><br></td></tr><tr><td>架构</td><td>环境变量等信息放在全局store里</td><td>随便放哪里都行</td><td><br></td></tr><tr><td>架构</td><td>react项目使用mobx。</td><td>使用redux、easy-peasy等。</td><td></td></tr><tr><td>架构</td><td>vue项目则使用export const store = new Vue()足够。</td><td>使用vuex。</td><td>Vuex has a bad support for TypeScript.</td></tr><tr><td>架构</td><td>直接使用rem做单位。</td><td>使用px2rem把px转换成rem。</td><td><ul><li>px2rem can not transform `px` in javascript files into `rem`.</li><li>Unable to use px in style files while using px2rem.</li></ul></td></tr><tr><td>组件</td><td>静态资源文件放在所属组件文件夹里。</td><td>静态资源文件都放在一个文件夹里</td><td><br></td></tr><tr><td>组件</td><td>import '@/components/'</td><td>import '@components'</td><td><br></td></tr><tr><td>组件</td><td>MyComponent/index.vue</td><td><br></td><td><br></td></tr><tr><td>组件</td><td>把函数作为prop传入子组件</td><td>this.$emit</td><td><br></td></tr><tr><td>组件</td><td>大组件使用动态加载。</td><td>不使用任何动态加载。</td><td><br></td></tr><tr><td>components</td><td>产出公共组件和函数。产出高度可复用的代码和开源lib往往标志着一个程序员的能力。</td><td>复制黏贴代码再改改</td><td><br></td></tr><tr><td>components</td><td>使用CommonExposure组件处理曝光埋点问题</td><td>每次都自己手写</td><td><br></td></tr><tr><td>components</td><td>DropArea</td><td><br></td><td><br></td></tr><tr><td><br></td><td><br></td><td><br></td><td><br></td></tr><tr><td>utils</td><td>toWebPage()</td><td>每个跳转都手写</td><td><br></td></tr><tr><td>utils</td><td>getSearchParams()</td><td>每次都手写</td><td><br></td></tr><tr><td>utils</td><td>resolveURL()</td><td>每次手动拼url字符串</td><td><br></td></tr><tr><td>utils</td><td>客户端的jssdk方法外层再进行一层封装。</td><td>不封装，直接用</td><td><br></td></tr><tr><td><br></td><td>&#x3C;img></td><td>background: url(...);</td><td><br></td></tr><tr><td><br></td><td>路由信息放到route.meta</td><td><br></td><td><br></td></tr><tr><td><br></td><td>生产环境不出现无用console</td><td><br></td><td><br></td></tr><tr><td><br></td><td>str.trim()</td><td>str.replace(/^\s+|\s+$/g, '');</td><td><br></td></tr><tr><td><br></td><td>不使用可能有浏览器兼容性问题的、太新的api。</td><td><br></td><td><br></td></tr><tr><td><br></td><td><p>必要的时候使用throw new Error抛出异常。</p><p>必要的时候使用try catch语句处理异常。<br><br><a href="../ji-shu-jian-she/bian-cheng-ji-qiao/error-handling.md">throw new Error();</a></p></td><td><p>把异常内部处理掉，不引起注意，美其名曰“容错”。</p><p>使用await-to-js。（是对golang处理异常方式的拙劣模仿，没有语言层面的支持。）<br><br>return Promise.reject();</p></td><td><ul><li>Errors should be caught then handled where the action is triggered, but not in a sub-action.</li></ul></td></tr><tr><td><br></td><td>使用tinypng等压缩图片</td><td>无论图片多大都不压缩</td><td><br></td></tr><tr><td><br></td><td><mark style="color:green;">/product?id=</mark><br><mark style="color:green;">Only pass id.</mark></td><td><p><mark style="color:red;">/product?productInfo=</mark></p><p><mark style="color:red;">通过url参数传递一大堆数据到详情页。</mark></p></td><td><br></td></tr><tr><td><br></td><td><p>排查问题的方法：</p><p>先把代码全部注释掉，然后一点一点加回来，看在哪一步出现了问题。</p></td><td><br></td><td><br></td></tr><tr><td><br></td><td>理解代码分层的意义，代码要出现在它应该出现的层里。</td><td><br></td><td><br></td></tr><tr><td><br></td><td>textAlign: 'left' | 'right' | 'center';</td><td>textAlign: 1 | 2 | 3;</td><td></td></tr></tbody></table>
